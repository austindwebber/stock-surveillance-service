<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>My Serverless Stock App</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
  <script src="https://cdn.zingchart.com/zingchart.min.js"></script>
  <script src="https://www.simplestockcharts.com/assets/src/simplestockchart.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $("#submit").click(function(e) {
        e.preventDefault();
        var stockTicker = $("#stockTicker").val();
        $.ajax({
          type: "POST",
          url: 'https://9hhkhg6iw3.execute-api.us-east-1.amazonaws.com/v2', contentType: 'application/json',
          data: JSON.stringify({
            'stockTicker': stockTicker
          }),
          success: function(res){

            console.log(res);


            var chart = new SimpleStockChart();
            chart.element = document.getElementById('chart');
            chart.key = 'Q4OESUB6H59YFL9Z';
            chart.ticker = res['stockTicker'];
            chart.chart.stroke = '#1d8f00';
            chart.font.fontSize = '14';
            chart.font.fontFill = '#ffffff';
            chart.style.width = '1000px';
            chart.style.height = '420px';
            chart.style.margin = '20px';
            chart.style.display = 'inline-flex';
            chart.minorAxis.count = 5;
            chart.draw();

            
            $('#company-image').html('<img src="' + res['image'] + '" style="height: 50px" >');
            $('#company-name').html(res['companyName'] + ": ");
            $('#stock-price').html('$' + res['price']);
            $('#form-response').show();
          },
          error: function(){
            $('#form-response').html('<div class="alert alert-info" role="alert">Oops! Something went wrong ... </div>');
          }
        });
      })
    });
  </script>
 <link rel="icon" type="image/ico" href="logo/favicon.ico">
 <link rel="stylesheet" href="css/index.css">
 <link rel="preconnect" href="https://fonts.gstatic.com">
 <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville&display=swap" rel="stylesheet"> 
</head>
<body>
  <div id="upper" class="bodyWrapper">
    <img src="logo/surveillance_logo_with_name.PNG" alt="Stock Surveillance">
    
    <br><p>Please enter a stock ticker for us to quote:</p>
    <p>
      <label for="stockTicker" class="control-label">Stock:</label>
      <input type="text" id="stockTicker" class="form-control" placeholder="Ticker" required />
      <button class="btn btn-lg btn-primary btn-block" id="submit" type="submit" style="background-color:#FCFAF9;">Check</button>
    </p>
  </div>
  <div id="lower" class="bodyWrapper">

    <div id="form-response" hidden>
      
      <div id="companyWrapper">
        <span id="company-image"></span>
        <span id="company-name"></span>
        <span id="stock-price"></span>
      </div>
      <br>
      <div id="chart"></div>

    </div>

  </div>
</body>
</html>
